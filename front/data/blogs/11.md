# How to do node scheduled tasks

## Introduction 

At present, we have encountered such a requirement that each user can customize the timing push. The time configuration of the timing task is configured by the user and can be modified at any time, instead of the traditional time set by the server to run the scheduled task.

If it is a known timed task cycle period, then the Linux Crontab timed task can be implemented. There are also relatively mature solutions in node. The following is an introduction to the Node timing task scheme that I have learned about myself.

## The schduler timing task provided by the egg framework

Egg is an enterprise-level application framework for Node under Alibaba. It provides a mechanism for developers to elegantly write scheduled tasks. For details, please refer to the official documentation: <a href="https://www.eggjs.org/">https://www.eggjs.org/</a> , I will not elaborate on the specific usage here, just briefly talk about its configuration usage.

1.Static timing tasks, that is, timing cycles, are fixed processing logic.

2.Dynamically configure timed tasks, which is relatively flexible, and developers can control the cycle of timed tasks through configuration files.

3.Manually triggering the scheduled task through code, we can determine whether to trigger the scheduled task according to some logic.

From the above three points, the timing tasks provided by egg cannot meet the needs of users to configure the timing cycle by themselves, so we can only seek other solutions. Through querying the data, we found that the node-schedule library also provides the function of timing tasks.

## node-schedule

After going through the documentation of <a href="https://www.npmjs.com/package/node-schedule">node-schudule</a>, uses it as follows:

```

const schedule = require('node-schedule');

const job = schedule.scheduleJob('42 * * * *', function(){
  console.log('The answer to life, the universe, and everything!');
});

```

Yes, he supports custom timing cycles, which can meet our needs and can be our choice, Nice!


## At last

Finally, here is a summary of our own project timing task solutions, students who are not interested can skip it.

Our backend uses the egg framework, so in the end our solution is to add a node-schdule timer to the agent process, and the user's timer will be executed in the synchronized agent process. At present, our number of users is not large. This is the only solution I can think of for the time being. The background may be deployed in a distributed manner after starting the volume. This will be a problem. If the volume is large, running a single process will also be a problem, and egg itself does not recommend doing too much in the agent process. business related stuff. Another important thing is that the agent is an auxiliary process. Some public work of the work is done in the agent. The agent will not exit and restart if an uncaught error occurs, so fault tolerance must be done and done well.

If you have a better solution, please leave a message to tell us(<a href="mailto:farmerlzj@163.com">farmerlzj@163.com</a>).