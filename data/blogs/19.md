# React中useEffect回调中状态值不更新问题

先来看个例子:

```

const Demo = ()=>{
  const [count,setCount] = useState(0);
  useEffect(()=>{
    setInterval(()=>{
      console.log(count);
      setCount(count+1);
    }, 1000)
  },[])
}

``` 

上面代码每秒打印的count值是多少。

答案： 始终为0；

useEffect内部缓存组件的状态值count,无论外部的count如何变化，都不会影响useEffect内部，所以此处count打印始终为0。

修正方法：count添加到useEffect的依赖当中，useEffect在组件状态count变化后会重新执行初始化，已更新内部状态值，不添加count依赖就不会更新，以此保证每次在effect内部始终保持最新的count值。

## 简易useEffect实现

