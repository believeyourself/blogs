<!DOCTYPE html><html><head><title data-react-helmet="true">Doris be 日志大量警告：/brpc/src/brpc/socket.cpp:1196] Fail to wait EPOLLOUT of fd=187: Connection timed out - 前端网</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <meta name="baidu-site-verification" content="code-TlaecuFEx5">
    <meta name="sogou_site_verification" content="wMb3kHjFi6">
    <meta name="shenma-site-verification" content="19dfe33fcd6f20294164ba6738d0e102_1634534936">
    <meta name="360-site-verification" content="e943e2d7714355d2d1af8f36b12c41f9">
    <meta name="baidu_union_verify" content="6f7381d4136832e99f86da0d67739a46">
    <meta name="bytedance-verification-code" content="d+FL9L0/4KxPwFbqXgmT">

    <!-- <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2087076429727327"
    crossOrigin="anonymous"></script> -->
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
    <link rel="stylesheet" href="/umi.css">
    <link rel="stylesheet" href="/layouts.chunk.css">
    <link rel="stylesheet" href="/p__blogs__detail__detail.chunk.css">
    <script>
      window.routerBase = "/";
    </script>
    <script>
      //! umi version: 3.5.18
    </script>
    <title>文章详情</title>
  <meta data-react-helmet="true" name="description" content="前端网,doris,aws,EC2,采用 stream load 方式导入数据，一段时间后大量警告日志：/brpc/src/brpc/socket.cpp:1196] Fail to wait EPOLLOUT of fd=187: Connection timed out"><meta data-react-helmet="true" name="keywords" content="前端网,doris,aws,EC2">
</head>

  <body>
    <div id="root"><header class="header___2_57M"><img alt="farmerLZJ" class="title___MhkPP" src="/static/logo.68ff92ec.png"/></header><div style="width:100%;position:relative;top:0;z-index:999"><nav class="nav___3wfA1"><a href="https://izejun.com/blogs" class="item___AqKVH active___1THnk">博客</a></nav></div><div class="content___2QN8t"><div class="content___1G4Bw"><header><a href="https://izejun.com/" class="back___26SyS undefined"> <!-- -->首页</a> <!-- -->/<a href="https://izejun.com/blogs" class="back___26SyS undefined"> <!-- -->博客</a></header><article><h1>Doris be 日志大量警告：/brpc/src/brpc/socket.cpp:1196] Fail to wait EPOLLOUT of fd=187: Connection timed out</h1>

<h2>背景</h2>

<p>测试环境：1台 fe（2核8G） + 3 台be（2核8G）,采用 stream load 方式导入数据，运行一段时间后，大量出现 Fail to wait EPOLLOUT of fd=187: Connection timed out [110] 的日志。</p>

<p>日志如下：</p>

<p><code></code>`
W0102 04:50:16.640652  4216 socket.cpp:1194] Fail to wait EPOLLOUT of fd=365: Connection timed out [110]
W0102 04:50:17.641734  4216 socket.cpp:1194] Fail to wait EPOLLOUT of fd=365: Connection timed out [110]
W0102 04:50:18.141074  4216 socket.cpp:1194] Fail to wait EPOLLOUT of fd=452: Connection timed out [110]
W0102 04:50:20.141149  4216 socket.cpp:1194] Fail to wait EPOLLOUT of fd=313: Connection timed out [110]
W0102 04:50:21.142115  4212 socket.cpp:1194] Fail to wait EPOLLOUT of fd=326: Connection timed out [110]</p>

<p><code></code>`</p>

<h2>Doris 状态</h2>

<p>导入数据量也不大，每次最多导入1000条数据，内存磁盘都正常，be大概还剩 1.5G 左右内存，磁盘 50G 的基本没消耗。</p>

<h2>如何解决</h2>

<p>暂时没找到原因，目前看并没有导致 be 挂掉。</p>

<p>网上找解决办法也没有找到，只有一个未解决的 &lt;a href=&quot;https://github.com/apache/incubator-brpc/issues/1410&quot; target=&quot;__blank&quot; rel=&quot;nofllow&quot;&gt;issue&lt;/a&gt;。</p>

<blockquote><p>1.对端启动了吗？
2.能提供下最小复现的代码吗，可能不是对端没有启动的原因
3.场景就是：client --- server --- backupend
如果client侧的timeout<em>ms比server到backupend的timeout</em>ms小的时候。
client超时，断开连接，server感知不到，导致链接处于CLOSE<em>WAIT，当超过了系统连接限制就进入假死状态。
4.--usercode</em>in<em>pthread=true
去掉这个，CLOSE</em>WAIT很快就释放了，如果存在这个配置，CLOSE<em>WAIT会一直存在。
6.如果client遇到超时关闭连接，但是server端还卡在和backupend通信中，并未结束请求，这时候CLOSE</em>WAIT是符合预期的</p></blockquote>

<p>知道问题原因或者解决办法的小伙伴请 &lt;a href=&quot;https://qianduan.shop/aboutUs&quot; target=&quot;__blank&quot; rel=&quot;nofllow&quot;&gt;留言&lt;/a&gt; 告诉我们，谢谢！</p></article><div><span class="ant-tag ant-tag-geekblue">#<span>doris</span></span><span class="ant-tag ant-tag-volcano">#<span>aws</span></span><span class="ant-tag ant-tag-error">#<span>EC2</span></span></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><ins class=" adsbygoogle" style="display:block;text-align:center;width:100%;height:90px" data-ad-client="ca-pub-2087076429727327" data-ad-slot="9331479126" data-ad-layout="" data-ad-layout-key="" data-ad-format="auto" data-full-width-responsive="false"></ins></div><div class="container___8WoUM"><p class="title___3k8xL">Online Tools</p><div class="tool_tags___1ccK5"><span class="ant-tag ant-tag-blue tool_tag___1JT6M">JSON Formater</span><span class="ant-tag ant-tag-cyan tool_tag___1JT6M">MD5</span><span class="ant-tag ant-tag-error tool_tag___1JT6M">timestamps</span><span class="ant-tag ant-tag-green tool_tag___1JT6M">Cron Expresstion</span></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><div style="text-align:center;height:300px"><ins class=" adsbygoogle" style="display:inline-block;width:250px;height:300px" data-ad-client="ca-pub-2087076429727327" data-ad-slot="7022357395" data-ad-layout="" data-ad-layout-key="" data-ad-format="auto" data-full-width-responsive="false"></ins></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><div style="text-align:center;height:300px"><ins class=" adsbygoogle" style="display:inline-block;width:250px;height:300px" data-ad-client="ca-pub-2087076429727327" data-ad-slot="7022357395" data-ad-layout="" data-ad-layout-key="" data-ad-format="auto" data-full-width-responsive="false"></ins></div></div></div><footer class="footer___3wR6c">©2021 farmerlzj 提供技术支持 | 联系我们：farmerlzj@163.com |<!-- --> <a href="https://beian.miit.gov.cn/" rel="nofollow" target="_blank">蜀ICP备2021025378号-1</a></footer><div class="ant-back-top"></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="https://cloud.qianduan.shop/react.min.js"></script>
    <script src="https://cloud.qianduan.shop/react-dom.min.js"></script>
    <script src="/umi.js"></script>
    <script src="/layouts.js"></script>
    <script src="/p__blogs__detail__detail.js"></script>
  

</body></html>