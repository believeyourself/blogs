<!--
 * @Date: 2022-01-20 14:27:07
 * @LastEditors: lzj
 * @LastEditTime: 2022-01-21 16:41:33
 * @FilePath: \qianduan.shop\front\src\pages\document.ejs
--><!DOCTYPE html><html><head><title data-react-helmet="true">Doris-1.4.2 Linux 直接编译问题记录 - 前端网</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2087076429727327" crossorigin="anonymous"></script>
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
    <link rel="stylesheet" href="/umi.css">
    <link rel="stylesheet" href="/layouts.chunk.css">
    <link rel="stylesheet" href="/p__blogs__detail__detail.chunk.css">
    <script>
      window.routerBase = "/";
    </script>
    <script>
      //! umi version: 3.5.18
    </script>
    <title>文章详情</title>
  <meta data-react-helmet="true" name="description" content="doris,aws,EC2,在 AWS 上的 EC2 直接编译 Doris，本文主要记录按官方文档操作直接编译过程中遇到的问题，方便查询。"><meta data-react-helmet="true" name="keywords" content="doris,aws,EC2">
</head>

  <body>
    <div id="root"><header class="header___2_57M"><img alt="farmerLZJ" class="title___MhkPP" src="/static/logo.68ff92ec.png"/></header><div style="width:100%;position:relative;top:0;z-index:999"><nav class="nav___3wfA1"><a href="https://izejun.com/blogs" class="item___AqKVH active___1THnk">Blog</a></nav></div><div class="content___2QN8t"><div class="content___1G4Bw"><article><p>&lt;!--
 <em> @Date: 2021-12-14 13:33:32
 </em> @LastEditors: lzj
 <em> @LastEditTime: 2021-12-15 16:25:31
 </em> @FilePath: \qianduan.shop\data\blogs\30.md
--&gt;</p>

<h1>Doris-1.4.2 Linux 直接编译问题记录</h1>

<p>官方文档：&lt;a href=&quot;https://doris.apache.org/master/zh-CN/installing/compilation.html#%E7%9B%B4%E6%8E%A5%E7%BC%96%E8%AF%91-centos-ubuntu&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;直接编译-centos-ubuntu&lt;/a&gt;</p>

<p>我是在 AWS 上的 EC2 进行的部署，本文主要记录<strong>按官方文档操作直接编译</strong>过程中遇到的问题，方便查询。</p>

<h2>1. EC2 实例选择</h2>

<p>不要太抠，我就是太抠，选了最便宜最小的测试，1核1G内存，8G 硬盘，不够用。</p>

<p>升到2核8G内存，24G 硬盘才完成编译，1G内存会报错提示：virtual memory exhausted: Cannot allocate memory。</p>

<p>&lt;hr /&gt;</p>

<h2>2.flex 版本太低，需要大于2.6.0</h2>

<p><code></code>`
  [ec2-user ~] wget https://github.com/westes/flex/releases/download/v2.6.4/flex-2.6.4.tar.gz
  [ec2-user ~] tar -xvf  flex-2.6.4.tar.gz
  [ec2-user ~] cd flex-2.6.4
  [ec2-user flex-2.6.4] ./configure
  [ec2-user flex-2.6.4] make
  [ec2-user flex-2.6.4] make install</p>

<p><code></code>`</p>

<p>flex 软件包来源：&lt;a href=&quot;https://bf.mengyan1223.wang/lfs/zh<em>CN/11.0/chapter03/packages.html&quot; target=&quot;</em>blank&quot; rel=&quot;nofollow&quot;&gt;Linux From Scratch - 版本 11.0-中文翻译版&lt;/a&gt;</p>

<p>&lt;hr /&gt;</p>

<h2>3.配置 JAVA_HOME 环境变量</h2>

<p>参考：&lt;a href=&quot;https://blog.csdn.net/qq<em>43491705/article/details/111354584&quot; target=&quot;</em>blank&quot; rel=&quot;nofollow&quot;&gt;linux配置JAVA_HOME环境&lt;/a&gt;</p>

<p>&lt;hr /&gt;</p>

<h2>4. cmake 版本太低，安装 cmake 提示找不到 openssl</h2>

<p>cmake 安装参考问题1 flex版本更新，软件包来源：&lt;a href=&quot;https://cmake.org/download/&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;CMake&lt;/a&gt;</p>

<p><code></code><code>
gmake: </code>cmake&#39; is up to date.
loading initial cache file /home/ec2-user/cmake-3.22.1/Bootstrap.cmk/InitialCacheFlags.cmake
-- Could NOT find OpenSSL, try to set the path to OpenSSL root folder in the system variable OPENSSL<em>ROOT</em>DIR (missing: OPENSSL<em>CRYPTO</em>LIBRARY OPENSSL<em>INCLUDE</em>DIR)
CMake Error at Utilities/cmcurl/CMakeLists.txt:562 (message):
  Could not find OpenSSL.  Install an OpenSSL development package or
  configure CMake with -DCMAKE<em>USE</em>OPENSSL=OFF to build without OpenSSL.</p>

<p><code></code>`</p>

<p><strong>解决办法：</strong></p>

<p><code></code>`
yum install -y openssl openssl-devel</p>

<p><code></code>`</p>

<h2>5.提示错误：fatal error: sasl/sasl.h: No such file or directory</h2>

<p>详细提示如下；
<code></code>`</p>

<h6></h6>

<h3>Configure failed</h3>

<h6></h6>

<h3>Accumulated failures:</h3>

<h6></h6>

<p> libsasl2 (WITH<em>SASL</em>CYRUS) 
    module: self
    action: fail
    reason:
compile check failed:
CC: CC
flags: -lsasl2
/usr/bin/../bin/gcc -fPIC -I/home/ec2-user/incubator-doris/thirdparty/installed/include -g -O2 -fPIC -Wall -Wsign-compare -Wfloat-equal -Wpointer-arith -Wcast-align -Wall -Werror <em>mkltmpDG8OLw.c -o </em>mkltmpDG8OLw.c.o  -L/home/ec2-user/incubator-doris/thirdparty/installed/lib -lsasl2:
_mkltmpDG8OLw.c:3:10: fatal error: sasl/sasl.h: No such file or directory
 #include &lt;sasl/sasl.h&gt;
          ^~~~~~~~~~~~~
compilation terminated.
source: </p>

<h1>include &lt;stddef.h&gt;</h1>

<h1>include &lt;sasl/sasl.h&gt;</h1>

<p> libsasl (WITH<em>SASL</em>CYRUS) 
    module: self
    action: fail
    reason:
compile check failed:
CC: CC
flags: -lsasl
/usr/bin/../bin/gcc -fPIC -I/home/ec2-user/incubator-doris/thirdparty/installed/include -g -O2 -fPIC -Wall -Wsign-compare -Wfloat-equal -Wpointer-arith -Wcast-align -Wall -Werror <em>mkltmpx7M6e0.c -o </em>mkltmpx7M6e0.c.o  -L/home/ec2-user/incubator-doris/thirdparty/installed/lib -lsasl:
_mkltmpx7M6e0.c:3:10: fatal error: sasl/sasl.h: No such file or directory
 #include &lt;sasl/sasl.h&gt;
          ^~~~~~~~~~~~~
compilation terminated.
source: </p>

<h1>include &lt;stddef.h&gt;</h1>

<h1>include &lt;sasl/sasl.h&gt;</h1>

<p><code></code>`</p>

<p><strong>解决办法</strong></p>

<p><code>
yum -y install cyrus-sasl cyrus-sasl-devel cyrus-sasl-lib
</code></p>

<h2>6.sudo yum install centos-release-scl 找不到</h2>

<p><strong>解决办法</strong></p>

<p><code></code>`
rpm -ivh https://cbs.centos.org/kojifiles/packages/centos-release-scl-rh/2/3.el7.centos/noarch/centos-release-scl-rh-2-3.el7.centos.noarch.rpm</p>

<p>rpm -ivh https://cbs.centos.org/kojifiles/packages/centos-release-scl/2/3.el7.centos/noarch/centos-release-scl-2-3.el7.centos.noarch.rpm</p>

<p><code></code>`</p>

<h2>7.sudo yum install devtoolset-10 依赖 libgfortran5 缺失</h2>

<p><strong>解决办法：</strong>
<code></code>`
rpm -ivh http://mirror.centos.org/centos/7/os/x86<em>64/Packages/libgfortran5-8.3.1-2.1.1.el7.x86</em>64.rpm</p>

<p><code></code>`</p>

<h2>8.sudo yum install devtoolset-10 报错：GPG key retrieval failed: [Errno 14] curl#37 - &quot;Couldn&#39;t open file /etc/pki/rpm-gpg/RPM-GPG-KEY-oracle&quot;</h2>

<p><code></code>`
wget http://public-yum.oracle.com/RPM-GPG-KEY-oracle-ol7 -O /etc/pki/rpm-gpg/RPM-GPG-KEY-oracle</p>

<p><code></code>`</p></article><div><span class="ant-tag ant-tag-geekblue">#<span>doris</span></span><span class="ant-tag ant-tag-volcano">#<span>aws</span></span><span class="ant-tag ant-tag-error">#<span>EC2</span></span></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><ins class=" adsbygoogle" style="display:block;text-align:center;width:100%;height:90px" data-ad-client="ca-pub-2087076429727327" data-ad-slot="9331479126" data-ad-layout="" data-ad-layout-key="" data-ad-format="auto" data-full-width-responsive="false"></ins></div><div class="container___8WoUM"><p class="title___3k8xL">Online Tools</p><div class="tool_tags___1ccK5"><span class="ant-tag ant-tag-blue tool_tag___1JT6M">JSON Formater</span><span class="ant-tag ant-tag-cyan tool_tag___1JT6M">MD5</span><span class="ant-tag ant-tag-error tool_tag___1JT6M">timestamps</span><span class="ant-tag ant-tag-green tool_tag___1JT6M">Cron Expresstion</span></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><div style="text-align:center;height:300px"><ins class=" adsbygoogle" style="display:inline-block;width:250px;height:300px" data-ad-client="ca-pub-2087076429727327" data-ad-slot="7022357395" data-ad-layout="" data-ad-layout-key="" data-ad-format="auto" data-full-width-responsive="false"></ins></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><div style="text-align:center;height:300px"><ins class=" adsbygoogle" style="display:inline-block;width:250px;height:300px" data-ad-client="ca-pub-2087076429727327" data-ad-slot="7022357395" data-ad-layout="" data-ad-layout-key="" data-ad-format="auto" data-full-width-responsive="false"></ins></div></div></div><footer class="footer___3wR6c">©2021 farmerlzj 提供技术支持 | 联系我们：farmerlzj@163.com |<!-- --> <a href="https://beian.miit.gov.cn/" rel="nofollow" target="_blank">蜀ICP备2021025378号-1</a></footer><div class="ant-back-top"></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="https://cloud.qianduan.shop/react.min.js"></script>
    <script src="https://cloud.qianduan.shop/react-dom.min.js"></script>
    <script src="/umi.js"></script>
    <script src="/layouts.js"></script>
    <script src="/p__blogs__detail__detail.js"></script>
  

</body></html>